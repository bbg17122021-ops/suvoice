<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>SuVoice TTS - FPT.AI</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 2rem;
      max-width: 600px;
      margin: auto;
      background: #f0f0f0;
    }
    textarea, select, input, button {
      width: 100%;
      margin: 0.5rem 0;
      padding: 0.7rem;
      font-size: 1rem;
    }
    label {
      font-weight: bold;
      margin-top: 1rem;
      display: block;
    }
    #downloadBtn {
      display: none;
      background: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h2>üîä SuVoice - FPT.AI TTS</h2>

  <textarea id="text" placeholder="Nh·∫≠p vƒÉn b·∫£n ti·∫øng Vi·ªát..."></textarea>

  <label for="voice">Ch·ªçn gi·ªçng ƒë·ªçc:</label>
  <select id="voice">
    <option value="banmai">N·ªØ - Ban Mai</option>
    <option value="leminh">Nam - L√™ Minh</option>
    <option value="myan">N·ªØ - M·ªπ An</option>
    <option value="minhquang">Nam - Minh Quang</option>
  </select>

  <label for="speed">T·ªëc ƒë·ªô ƒë·ªçc (0.5 ‚Üí 1.5): <span id="speedValue">1</span></label>
  <input type="range" id="speed" min="0.5" max="1.5" step="0.1" value="1" />

  <button onclick="speak()">‚ñ∂Ô∏è ƒê·ªçc vƒÉn b·∫£n</button>
  <audio id="audio" controls style="margin-top:1rem; width:100%"></audio>
  <button id="downloadBtn">‚¨áÔ∏è T·∫£i file MP3</button>

  <script>
    const API_KEY = "GAacsKsBDMjUiqu04JKFi05wCT1qBgKZ";
    const textInput = document.getElementById("text");
    const voiceSelect = document.getElementById("voice");
    const speedInput = document.getElementById("speed");
    const speedValue = document.getElementById("speedValue");
    const audioPlayer = document.getElementById("audio");
    const downloadBtn = document.getElementById("downloadBtn");

    speedInput.addEventListener("input", () => {
      speedValue.textContent = speedInput.value;
    });

    async function speak() {
      const text = textInput.value.trim();
      if (!text) return alert("Vui l√≤ng nh·∫≠p vƒÉn b·∫£n.");

      const voice = voiceSelect.value;
      const speed = speedInput.value;

      const response = await fetch("https://api.fpt.ai/hmi/tts/v5", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "api-key": API_KEY
        },
        body: JSON.stringify({
          text,
          voice,
          speed: parseFloat(speed)
        })
      });

      const result = await response.json();
      if (result && result.async) {
        audioPlayer.src = result.async;
        audioPlayer.play();

        // Hi·ªÉn th·ªã n√∫t t·∫£i file
        downloadBtn.style.display = "inline-block";
        downloadBtn.onclick = () => {
          const link = document.createElement("a");
          link.href = result.async;
          link.download = "suvoice.mp3";
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
        };
      } else {
        alert("Kh√¥ng th·ªÉ t·∫°o gi·ªçng n√≥i. Ki·ªÉm tra l·∫°i API key ho·∫∑c vƒÉn b·∫£n.");
      }
    }
  </script>
</body>
</html>
